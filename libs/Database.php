<?php
class Database extends PDO{function __construct(){parent::__construct(DB_TYPE.":host=".DB_HOST.";dbname=".DB_NAME,DB_USER,DB_PASS);$this->post=new Post();}function field($a){$b=$this->prepare("DESCRIBE ".$a);$b->execute();$c=$b->fetchAll(PDO::FETCH_ASSOC);return $c;}function create($a,$d=array()){$this->setAttribute(PDO::ATTR_EMULATE_PREPARES,false);if(empty($d)){$e=$this->field($a);foreach($e as $f){if($f['Type']!='timestamp'){$this->post->set($f['Field']);}}$d=$this->post->get();}$g=implode(", ",array_keys($d));$h=":".implode(", :",array_keys($d));$i=implode(", ",$d);$j="INSERT INTO $a($g) VALUES($i)";$b=$this->prepare("INSERT INTO $a($g) VALUES($h)");if(!$b){$k=$this->errorInfo();echo $k[2]."<br>please check this query &rArr; ".$j;die();}else{foreach($d as $l=>$m){$b->bindValue(":$l",$m);}$b->execute();}}function read($a,$n=null,$g="*"){$this->setAttribute(PDO::ATTR_EMULATE_PREPARES,false);$j="SELECT $g FROM $a $n";$b=$this->prepare($j);if(!$b){$k=$this->errorInfo();echo $k[2]."<br>please check this query &rArr; ".$j;die();}else{$b->execute();$c=$b->fetchAll(PDO::FETCH_ASSOC);return $c;}}function update($a,$o,$d=array()){if(empty($d)){$e=$this->field($a);foreach($e as $f){if($f['Type']!='timestamp'){$m[]=$f['Field']." = :".$f['Field'];$this->post->set($f['Field']);}}$d=$this->post->get();}else{foreach($d as $l=>$i){$m[]=$l." = :".$l;}}$h=implode(", ",$m);$b=$this->prepare("UPDATE $a SET $h WHERE $o");if(!$b){$k=$this->errorInfo();echo $k[2];die();}else{foreach($d as $l=>$m){$b->bindValue(":$l",$m);}$b->execute();}}function delete($a,$o){$this->exec("DELETE FROM $a WHERE $o");}function upload($d,$p=null,$q=null){$r=$_FILES[$d];$s=$r['name'];move_uploaded_file($r['tmp_name'],"$p/".$s);if(!is_null($q)){$t=explode(".",$s);$q=$q.".".end($t);rename("$p/".$s,"$p/".$q);$r['name']=$q;$s=$q;}chmod("$p/".$s,0777);return $r;}function one($a,$n=null,$g="*"){$this->setAttribute(PDO::ATTR_EMULATE_PREPARES,false);$j="SELECT $g FROM $a $n";$b=$this->prepare($j);if(!$b){$k=$this->errorInfo();echo $k[2]."<br>please check this query &rArr; ".$j;die();}else{$b->execute();$c=$b->fetch(PDO::FETCH_ASSOC);return $c;}}function custome($a){try{$b=$this->prepare("$a");$b->execute();$c=$b->fetchAll(PDO::FETCH_ASSOC);return $c;}catch(PDOException $d){$d->getMessage();$this->setAttribute(PDO::ATTR_EMULATE_PREPARES,false);$f=$this->errorInfo();echo $f[2];die();}}}